<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Home - Sistema Clínico</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<style>
:root {
    --primary: #2f80ed;
    --primary-dark: #1c5fb8;
    --bg-light: #f4f6f9;
    --bg-dark: #121212;
    --card-dark: #1e1e1e;
}

body {
    margin: 0;
    font-family: 'Segoe UI', Arial, sans-serif;
    background: var(--bg-light);
}

/* SIDEBAR */
.sidebar {
    width: 230px;
    height: 100vh;
    background: linear-gradient(180deg, var(--primary), var(--primary-dark));
    position: fixed;
    padding-top: 1.5rem;
}

.sidebar h4,
.sidebar small {
    color: #fff;
    text-align: center;
}

.sidebar a {
    color: #fff;
    padding: 0.9rem 1.2rem;
    display: flex;
    align-items: center;
    text-decoration: none;
    transition: all .2s;
}

.sidebar a.active,
.sidebar a:hover {
    background-color: var(--primary-dark);
    padding-left: 1.6rem;
}

.sidebar .submenu a {
    padding-left: 2.8rem;
    font-size: 0.9rem;
    background-color: rgba(255,255,255,0.08);
}

/* MAIN */
.main-content {
    margin-left: 230px;
    min-height: 100vh;
}

/* HEADER */
.header {
    background: #fff;
    padding: 1rem 2rem;
    border-bottom: 1px solid #ddd;
}

.user-box {
    display: flex;
    align-items: center;
    gap: .75rem;
}

.avatar {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: var(--primary);
    color: #fff;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* CONTENT */
.content {
    padding: 2rem;
}

/* DARK MODE */
body.dark-mode {
    background: var(--bg-dark);
    color: #eaeaea;
}

body.dark-mode .header,
body.dark-mode .card {
    background: var(--card-dark);
    color: #eaeaea;
}

body.dark-mode .sidebar {
    background: linear-gradient(180deg, #1f1f1f, #141414);
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
    <h4>Sistema Clínico</h4>
    <small>Gestão de Saúde</small>

    <div class="text-center my-3">
        <button id="toggleDark" class="btn btn-light btn-sm rounded-circle">
            <i class="bi bi-moon-fill"></i>
        </button>
    </div>

    <a href="{% url 'home' %}" class="active">
        <i class="bi bi-house-fill me-2"></i> Início
    </a>

    <a href="{% url 'trocar_senha_por_cpf' %}">
        <i class="bi bi-key-fill me-2"></i> Trocar Senha
    </a>

    <a data-bs-toggle="collapse" href="#menuCadastrar">
        <i class="bi bi-plus-circle-fill me-2"></i> Cadastros
        <i class="bi bi-chevron-down ms-auto"></i>
    </a>

    <div class="collapse submenu" id="menuCadastrar">
        <a href="{% url 'usuario_create' %}">
            <i class="bi bi-person-plus-fill me-2"></i> Usuário
        </a>
        <a href="{% url 'adicionar_paciente' %}">
            <i class="bi bi-person-heart me-2"></i> Paciente
        </a>
    </div>

    <a data-bs-toggle="collapse" href="#menuListar">
        <i class="bi bi-list-ul me-2"></i> Listagens
        <i class="bi bi-chevron-down ms-auto"></i>
    </a>

    <div class="collapse submenu" id="menuListar">
        <a href="{% url 'usuario_list' %}">
            <i class="bi bi-people-fill me-2"></i> Usuários
        </a>
        <a href="{% url 'listar_pacientes' %}">
            <i class="bi bi-person-heart me-2"></i> Pacientes
        </a>
    </div>

    <hr class="text-white mx-3">

    <a href="{% url 'logout' %}">
        <i class="bi bi-box-arrow-right me-2"></i> Sair
    </a>
</div>

<!-- MAIN -->
<div class="main-content">

    {% if request.user.is_authenticated %}
    <div class="header d-flex justify-content-between align-items-center">
        <h5 class="mb-0 fw-bold text-primary">Painel</h5>

        <div class="dropdown">
            <div class="user-box dropdown-toggle" data-bs-toggle="dropdown">
                <div class="avatar">
                    {{ request.user.first_name|first|upper }}
                </div>
                <div class="text-end">
                    <div class="fw-semibold">
                        {{ request.user.get_full_name|default:request.user.username }}
                    </div>
                    <small class="text-muted">
                        {{ request.user.profile.cpf|default:"Não informado" }}
                    </small>
                </div>
            </div>

            <ul class="dropdown-menu dropdown-menu-end">
                <li>
                    <a class="dropdown-item" href="{% url 'trocar_senha_por_cpf' %}">
                        <i class="bi bi-key me-2"></i> Alterar Senha
                    </a>
                </li>
                <li><hr class="dropdown-divider"></li>
                <li>
                    <a class="dropdown-item text-danger" href="{% url 'logout' %}">
                        <i class="bi bi-box-arrow-right me-2"></i> Sair
                    </a>
                </li>
            </ul>
        </div>
    </div>
    {% endif %}

    <!-- CONTENT -->
    <div class="content">
        <h3 class="fw-bold mb-2">Bem-vindo ao Sistema Clínico</h3>
        <p class="text-muted mb-4">
            Gerencie usuários e informações da clínica de forma segura e eficiente.
        </p>

        <div class="row g-4">
            <!-- Usuários -->
            <div class="col-md-3 col-sm-6">
                <div class="card shadow-sm border-0 rounded-4 text-center p-4">
                    <i class="bi bi-people-fill fs-1 text-primary"></i>
                    <h6 class="mt-3">Usuários</h6>
                    <a href="{% url 'usuario_list' %}" class="btn btn-outline-primary btn-sm mt-2">
                        Gerenciar
                    </a>
                </div>
            </div>

            <div class="col-md-3 col-sm-6">
                <div class="card shadow-sm border-0 rounded-4 text-center p-4">
                    <i class="bi bi-person-plus-fill fs-1 text-primary"></i>
                    <h6 class="mt-3">Novo Usuário</h6>
                    <a href="{% url 'usuario_create' %}" class="btn btn-outline-primary btn-sm mt-2">
                        Cadastrar
                    </a>
                </div>
            </div>

           


            <!-- Pacientes -->
           

            <div class="col-md-3 col-sm-6">
                <div class="card shadow-sm border-0 rounded-4 text-center p-4">
                    <i class="bi bi-person-plus-fill fs-1 text-primary"></i>
                    <h6 class="mt-3">Pacientes</h6>
                    <a href="{% url 'listar_pacientes' %}" class="btn btn-outline-primary btn-sm mt-2">
                       Gerenciar
                    </a>
                </div>
            </div>

            <div class="col-md-3 col-sm-6">
                <div class="card shadow-sm border-0 rounded-4 text-center p-4">
                    <i class="bi bi-person-plus-fill fs-1 text-primary"></i>
                    <h6 class="mt-3">Novo Paciente</h6>
                    <a href="{% url 'adicionar_paciente' %}" class="btn btn-outline-primary btn-sm mt-2">
                        Cadastrar
                    </a>
                </div>
            </div>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
const toggle = document.getElementById('toggleDark');
const body = document.body;

if (localStorage.getItem('darkMode') === 'on') {
    body.classList.add('dark-mode');
    toggle.innerHTML = '<i class="bi bi-sun-fill"></i>';
}

toggle.addEventListener('click', () => {
    body.classList.toggle('dark-mode');
    localStorage.setItem(
        'darkMode',
        body.classList.contains('dark-mode') ? 'on' : 'off'
    );
    toggle.innerHTML = body.classList.contains('dark-mode')
        ? '<i class="bi bi-sun-fill"></i>'
        : '<i class="bi bi-moon-fill"></i>';
});
</script>

</body>
</html>
