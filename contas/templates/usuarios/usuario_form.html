{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>{{ titulo }} - PT Saúde</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-7">

            <div class="card shadow-sm border-0 rounded-4">
                <div class="card-header bg-danger text-white rounded-top-4">
                    <h5 class="mb-0">
                        <i class="bi bi-person-fill me-2"></i> {{ titulo }}
                    </h5>
                </div>

                <div class="card-body p-4">
                    <form method="POST">
                        {% csrf_token %}
                                {% if form.non_field_errors %}
<div class="alert alert-danger">
    {% for error in form.non_field_errors %}
        {{ error }}
    {% endfor %}
</div>
{% endif %}

                        <!-- Usuário e CPF -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Usuário</label>
                                {{ form.username|add_class:"form-control" | attr:"placeholder:Ex: clinica01" }}
                                

                            </div>

                            <div class="col-md-6 mb-3">
    <label class="form-label">CPF</label>

    {{ form.cpf|add_class:"form-control"|attr:"id:cpf" }}

    {% if form.cpf.errors %}
        <div class="text-danger small mt-1">
            {% for error in form.cpf.errors %}
                {{ error }}
            {% endfor %}
        </div>
    {% endif %}
</div>


                        </div>

                        <!-- Nome e Sobrenome -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Nome</label>
                                {{ form.first_name|add_class:"form-control" | attr:"placeholder:Nome" }}
                            </div>
                                
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Sobrenome</label>
                                {{ form.last_name|add_class:"form-control" | attr:"placeholder:Sobrenome" }}
                            </div>
                        </div>

                        <!-- Email -->
                        <div class="mb-3">
                            <label class="form-label">E-mail</label>
                            {{ form.email|add_class:"form-control" | attr:"placeholder:email@dominio.com" }}
                        </div>

                        <!-- Senhas -->
                        {% if form.password %}
                        <hr>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Senha</label>
                                {{ form.password|add_class:"form-control" | attr:"placeholder:Senha segura" }}
                            </div>

                            <div class="col-md-6 mb-3">
                                <label class="form-label">Confirmar Senha</label>
                                {{ form.confirm_password|add_class:"form-control" | attr:"placeholder:Repita a senha" }}
                            </div>
                        </div>
                        {% endif %}

                        <!-- Botões -->
                        <div class="d-flex justify-content-end gap-2 mt-4">
                            <a href="{% url 'home' %}" class="btn btn-outline-secondary">
                                <i class="bi bi-arrow-left"></i> Voltar
                            </a>

                            <button class="btn btn-danger px-4">
                                <i class="bi bi-save-fill me-1"></i> Salvar
                            </button>
                        </div>

                    </form>
                </div>

            </div>

        </div>
    </div>
</div>

</body>
</html>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const cpfInput = document.getElementById("cpf");

    if (cpfInput) {
        cpfInput.addEventListener("input", function () {
            let value = cpfInput.value.replace(/\D/g, "");

            if (value.length > 11) {
                value = value.slice(0, 11);
            }

            value = value.replace(/(\d{3})(\d)/, "$1.$2");
            value = value.replace(/(\d{3})(\d)/, "$1.$2");
            value = value.replace(/(\d{3})(\d{1,2})$/, "$1-$2");

            cpfInput.value = value;
        });
    }
});
</script>
